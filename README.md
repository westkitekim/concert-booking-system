<!--
## 프로젝트

## Getting Started

### Prerequisites

#### Running Docker Containers

`local` profile 로 실행하기 위하여 인프라가 설정되어 있는 Docker 컨테이너를 실행해주셔야 합니다.

```bash
docker-compose up -d
```

-->

# 🎤 콘서트 예약 시스템 
본 프로젝트는 실제 서비스에 가까운 공연 예매 기능을 구현하는 시스템이다. <br/>
사용자 대기열 처리, 좌석 임시 점유, 잔액 충전 및 결제까지의 흐름을 시나리오 기반으로 설계하고, 동시성 제어와 공정성을 고려해 구현한다.<br/>
테스트 가능한 구조로 설계하여 유지보수성과 확장성을 갖춘 시스템을 구현하는데에 목적이 있다.
<br/>

## 🚗 마일스톤
- [마일스톤 링크](https://github.com/users/westkitekim/projects/1/views/1)
<br/>

## 📚 요구사항 분석 및 설계
- [분석 및 설계 문서 링크](docs/requirement-analysis-design.md)
<br/>

## 📌 요구사항
### 1. 대기열 토큰 API
- 사용자 고유 토큰은 UUID 기반으로 생성, userId, position의 정보 포함하여 대기열 진입 허용
- 대기열 진입 시 중복 사용자 방지를 위해 기존 토큰 존재 여부를 확인.
- 별도 스케줄러 혹은 조회 API를 통해 주기적으로 현재 유저의 대기 상태 확인.
- 대기열에 존재하는 사용자만 예약 관련 API 호출.

### 2. 예약 가능 날짜 및 좌석 조회 API
- 예약 가능한 날짜 조회
- 특정 콘서트 날짜에 대한 예약 가능한 좌석 목록 조회.
- 임시 점유 상태의 좌석은 제외하고 응답.
- 좌석 정보는 좌석번호, 예약 가능 여부, 보유 유저 ID 등의 정보 포함.

### 3. 좌석 예약 API
- 좌석 번호 : 1 ~ 50번
- 임시 점유 유효 시간 : 5분
- 특정 좌석 번호 및 날짜를 전달받아 좌석을 임시 점유 상태로 변경.
- 유효 시간동안 다른 사용자 예약 불가. 
- 유효 시간 만료시 임시 점유 해제 및 해제된 좌석 조회 가능.

### 4. 잔액 충전 및 조회 API
- 잔액 조회 : 사용자가 보유한 잔액을 조회.
- 잔액 충전 : 사용자의 ID와 충전 금액을 기반으로 잔액 충전.
- 잔액 충전 시 잔액 이력(balance_histories) 적재.

### 5. 결제 API
- 결제 처리
  - 임시 점유된 좌석 대상으로 사용자의 잔액 사용(차감)
  - 결제 이력 적재, 예약 정보 확정.
- 결제 완료
  - 사용자에게 좌석 소유권 이전.
  - 좌석 소유권 이전 후, 대기열 토큰 만료 처리.
- 결제 실패
  - 임시 점유 좌석 해제.



